---
title: "Assignement1/2"
author: "Daniela"
date: "2025-01-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries
```{r libraries}
library(ggplot2)
library(sf)
library(dplyr)
library(RColorBrewer)
library(gridExtra)
```

## Load data
```{r data}
pop <- st_read("/Users/danielaguggenberger/Documents/Dokumente - MacBook Air von Daniela/BSE/GeoSpatial/PS2/data/ne_110m_populated_places/ne_110m_populated_places.shp")
countries <- st_read("/Users/danielaguggenberger/Documents/Dokumente - MacBook Air von Daniela/BSE/GeoSpatial/PS2/data/ne_110m_admin_0_countries/ne_110m_admin_0_countries.shp")
countries <- st_as_sf(countries)
airports <- st_read("/Users/danielaguggenberger/Documents/Dokumente - MacBook Air von Daniela/BSE/GeoSpatial/PS2/data/ne_10m_airports/ne_10m_airports.shp")
airports <- st_as_sf(airports)
airports <- st_transform(airports, crs = 4326)
ports <- st_read("/Users/danielaguggenberger/Documents/Dokumente - MacBook Air von Daniela/BSE/GeoSpatial/PS2/data/ne_10m_ports/ne_10m_ports.shp")
ports <- st_as_sf(ports)
ports <- st_transform(ports, crs = 4326)
```

```{r plots}
# Plot the world map
ggplot(data = countries) +
  geom_sf(fill = "lightblue", color = "black") +  # Fill color and borders
  theme_minimal() + 
  labs(title = "World Map")

#airports on map
ggplot() +
  # Plot world map
  geom_sf(data = countries, fill = "lightblue", color = "black") +
  # Plot airports on top
  geom_sf(data = airports, color = "yellow", size = 1) +
  theme_minimal() +
  labs(title = "World Map with Airports")

#ports on map
ggplot() +
  # Plot world map
  geom_sf(data = countries, fill = "lightblue", color = "black") +
  # Plot airports on top
  geom_sf(data = ports, color = "red", size = 1) +
  theme_minimal() +
  labs(title = "World Map with Ports")
````

```{r plot population}
ggplot(data = countries) +
  geom_sf(aes(fill = POP_EST), color = "black", size = 0.2) +  # Fill based on population
  scale_fill_viridis_b(option = "plasma", trans = "log", name = "Population", 
                       breaks = c(1e6, 1e7, 1e8, 1e9),  # Define readable breaks
                       labels = c("1M", "10M", "100M", "1B")) +  # Format labels
  theme_minimal() +
  labs(title = "World Population by Country",
       subtitle = "Based on Estimated Population (pop_est)",
       caption = "Source: Natural Earth / Your Dataset") +
  theme(legend.position = "right",  # Move legend to the right side
        legend.text = element_text(size = 10),  # Increase text size
        legend.title = element_text(size = 12, face = "bold"),  # Bold legend title
        legend.key.height = unit(1, "cm"))  
````

```{r plot hist}
plot_population_distribution <- function(continent_name) {
  continent_data <- countries_clean %>% filter(CONTINENT == continent_name)
  
  ggplot(continent_data, aes(x = reorder(NAME, POP_EST), y = POP_EST)) + 
    geom_bar(stat = "identity", fill = "steelblue") +  # Bar plot for population
    labs(title = paste("Population Distribution of", continent_name, "Countries"),
         x = "Country",
         y = "Population") +
    scale_y_continuous(labels = scales::comma) +  # Format y-axis with commas
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
}

# List of continents
continents <- c("North America", "South America", "Asia", "Europe", "Africa")

# Apply the function to each continent and create the plots
plots <- map(continents, plot_population_distribution)


plot_population_distribution("South America")
plot_population_distribution("North America")
plot_population_distribution("Asia")
plot_population_distribution("Europe")
plot_population_distribution("Africa")
````

```{r }
````

